# 卡密系统新功能测试清单

## 🎯 测试概述
本清单用于验证卡密系统新增的商品管理、筛选、导出等功能是否正常工作。

## 📋 数据库结构测试

### ✅ 商品表(products)
- [ ] 表是否存在
- [ ] 字段完整性检查
  - [ ] id (主键)
  - [ ] name (商品名称)
  - [ ] description (描述)
  - [ ] status (状态)
  - [ ] create_time (创建时间)
  - [ ] update_time (更新时间)
  - [ ] sort_order (排序)
- [ ] 默认商品是否存在
- [ ] 索引是否正确创建

### ✅ 卡密表(cards)更新
- [ ] product_id字段是否添加
- [ ] 外键约束是否创建
- [ ] 新增索引是否存在
- [ ] 现有数据是否正确迁移

## 🏪 商品管理功能测试

### ✅ 商品列表页面
- [ ] 页面正常加载
- [ ] 商品列表正确显示
- [ ] 卡密统计信息准确
- [ ] 排序功能正常

### ✅ 添加商品
- [ ] 添加表单正常显示
- [ ] 必填字段验证
- [ ] 商品名称重复检查
- [ ] 成功添加商品
- [ ] 错误信息正确显示

### ✅ 编辑商品
- [ ] 编辑表单预填充数据
- [ ] 修改商品信息
- [ ] 保存成功
- [ ] 数据更新正确

### ✅ 商品状态管理
- [ ] 启用/禁用商品
- [ ] 默认商品不能禁用
- [ ] 状态变更正确反映

### ✅ 删除商品
- [ ] 有卡密的商品不能删除
- [ ] 无卡密的商品可以删除
- [ ] 默认商品不能删除
- [ ] 确认对话框正常

## 🎫 卡密生成功能测试

### ✅ 商品选择
- [ ] 商品下拉列表正确显示
- [ ] 只显示启用的商品
- [ ] 默认选择第一个商品
- [ ] 选择不同商品正常

### ✅ 卡密生成
- [ ] 选择商品后生成卡密
- [ ] 卡密正确关联到商品
- [ ] 批量生成功能正常
- [ ] 生成数量限制正确

### ✅ 数据验证
- [ ] 商品ID正确保存
- [ ] 无效商品ID自动使用默认商品
- [ ] 数据库记录正确

## 🔍 筛选功能测试

### ✅ 商品筛选
- [ ] 商品下拉列表正确
- [ ] 选择商品后筛选正确
- [ ] "全部商品"选项正常
- [ ] 筛选结果准确

### ✅ 状态筛选
- [ ] 状态选项完整
- [ ] 筛选结果正确
- [ ] 多条件组合筛选

### ✅ 类型筛选
- [ ] 时间卡密筛选
- [ ] 次数卡密筛选
- [ ] 筛选结果准确

### ✅ 时间筛选
- [ ] 开始日期筛选
- [ ] 结束日期筛选
- [ ] 日期范围筛选
- [ ] 日期格式验证

### ✅ 筛选交互
- [ ] 筛选按钮功能
- [ ] 清除筛选功能
- [ ] 筛选条件保持
- [ ] 分页保持筛选

## 📤 导出功能测试

### ✅ Excel导出（原有功能）
- [ ] 选中卡密导出
- [ ] 导出文件格式正确
- [ ] 数据完整性
- [ ] 包含商品信息

### ✅ TXT导出（新功能）
- [ ] 导出模态框正常显示
- [ ] 文件名自定义
- [ ] 导出数量选择
  - [ ] 仅选中卡密
  - [ ] 当前筛选结果
  - [ ] 自定义数量
- [ ] 字段选择功能
- [ ] 导出格式选择
  - [ ] 每行一个卡密
  - [ ] 详细信息格式

### ✅ 导出数据验证
- [ ] TXT文件格式正确
- [ ] 数据完整准确
- [ ] 字段顺序正确
- [ ] 中文编码正确

## 🔌 API验证功能测试

### ✅ 商品验证参数
- [ ] product_id参数接收
- [ ] GET请求支持
- [ ] POST请求支持
- [ ] JSON格式支持

### ✅ 验证逻辑
- [ ] 无product_id时正常验证
- [ ] 有product_id时验证商品匹配
- [ ] 商品不匹配返回错误
- [ ] 商品被禁用返回错误

### ✅ 响应数据
- [ ] 成功响应包含商品信息
- [ ] 错误响应信息准确
- [ ] 响应格式正确
- [ ] 状态码正确

### ✅ 兼容性测试
- [ ] 旧版API调用正常
- [ ] 新版API功能正确
- [ ] 向后兼容性

## 🎨 前端界面测试

### ✅ 响应式设计
- [ ] 桌面端显示正常
- [ ] 平板端适配
- [ ] 手机端适配
- [ ] 横竖屏切换

### ✅ 用户体验
- [ ] 加载动画
- [ ] 错误提示
- [ ] 成功提示
- [ ] 操作确认

### ✅ 交互功能
- [ ] 模态框操作
- [ ] 表单验证
- [ ] 快捷键支持
- [ ] 工具提示

### ✅ 浏览器兼容性
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

## 🔒 安全性测试

### ✅ 输入验证
- [ ] SQL注入防护
- [ ] XSS防护
- [ ] CSRF防护
- [ ] 参数验证

### ✅ 权限控制
- [ ] 管理员认证
- [ ] API密钥验证
- [ ] 会话管理
- [ ] 访问控制

## 📊 性能测试

### ✅ 数据库性能
- [ ] 查询执行时间
- [ ] 索引使用情况
- [ ] 大数据量测试
- [ ] 并发访问测试

### ✅ 前端性能
- [ ] 页面加载速度
- [ ] 资源加载优化
- [ ] 内存使用情况
- [ ] 交互响应时间

## 🔄 集成测试

### ✅ 功能集成
- [ ] 商品管理与卡密生成
- [ ] 筛选与导出
- [ ] API与数据库
- [ ] 前后端交互

### ✅ 数据一致性
- [ ] 商品删除影响
- [ ] 状态变更同步
- [ ] 统计数据准确
- [ ] 缓存更新

## 🚀 部署测试

### ✅ 新安装测试
- [ ] 全新安装流程
- [ ] 数据库初始化
- [ ] 默认数据创建
- [ ] 功能可用性

### ✅ 升级测试
- [ ] 从旧版本升级
- [ ] 数据迁移正确
- [ ] 功能兼容性
- [ ] 配置保持

## 🔌 API接口测试

### ✅ API基础功能
- [ ] API接口启用/禁用
- [ ] API密钥生成和管理
- [ ] API密钥状态控制
- [ ] 请求认证验证

### ✅ 卡密+商品验证API
- [ ] POST请求验证（必须包含商品ID）
- [ ] GET请求验证（必须包含商品ID）
- [ ] 时间卡密验证
- [ ] 次数卡密验证
- [ ] 卡密与商品匹配验证
- [ ] 设备绑定机制
- [ ] 重复验证控制
- [ ] 缺少商品ID参数的错误处理

### ✅ API安全性
- [ ] 无效API密钥拒绝
- [ ] 参数验证
- [ ] 错误信息安全

### ✅ API测试工具
- [ ] quick_test.py 基础测试（已更新支持商品ID）
- [ ] test_new_features.py 完整测试
- [ ] test_config.py 配置管理（已添加商品ID配置）
- [ ] simple_api_test.py 新API专用测试

## 📝 测试记录

### 测试环境
- 操作系统：
- PHP版本：
- MySQL版本：
- 浏览器：

### 测试结果
- 通过项目：___/___
- 失败项目：___/___
- 测试日期：
- 测试人员：

### 问题记录
| 问题描述 | 严重程度 | 状态 | 备注 |
|---------|---------|------|------|
|         |         |      |      |

---

**测试说明：**
- ✅ 表示需要测试的项目
- 请在测试完成后在对应项目前打勾
- 发现问题请详细记录在问题记录表中
- 建议按模块顺序进行测试
